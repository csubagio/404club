<html><head><meta name="viewport" content="width=device-width, user-scalable=no"><title>404 Club</title><style>body,canvas,html,p{padding:0;margin:0}body,canvas,html{overflow:hidden;width:100%;height:100%}#t,#v{position:absolute}#t{left:50%;top:50%;font:min(50vh,50vw) sans-serif;transform:translate(-50%,-50%);background:#444;padding:100vh;color:#999;line-height:1;text-align:center;cursor:pointer;white-space:pre;user-select:none}i{text-shadow:1vh 1vh #000}p{font-size:min(5vh,20vw)}#v{left:0;top:0;width:100%;height:100%;box-shadow:0 0 10vh #0f111f inset;pointer-events:none;z-index:1000}</style></head><body><div id='t'>404</div><div id='v'></div><script>let e,n,o=document.createElement("canvas");function a(){e=o.clientWidth,n=o.clientHeight,o.width=e,o.height=n}document.body.append(o),window.onresize=a,a();let l,s,c,f,u,p,m,h=o.getContext("webgl",{antialising:!0,premultipliedAlpha:!1});function d(){l=new(window.AudioContext||window.webkitAudioContext),s=l.createGain(),s.connect(l.destination);let e=.15,n=.05;for(let t=0;t<4;++t){let t=l.createDelay();t.delayTime.value=e+.05*Math.random();let r=l.createGain();r.gain.value=n,e+=.15,n/=2,t.connect(r),r.connect(l.destination),s.connect(t)}let r=1*l.sampleRate,o=l.createBuffer(1,r,l.sampleRate),i=o.getChannelData(0);for(var a=0;a<r;a++)t=1*a/r,i[a]=Math.min(1,Math.max(-1,.1*Math.tan(270*t)+.2*Math.tan(430*t)+.2*Math.tan(100*t)+.1*(2*Math.random()-1)))*Math.pow(1-t,4)*.1;let c=l.createConvolver();c.buffer=o,c.connect(l.destination),(()=>{let t=l.createBuffer(1,4096,l.sampleRate),e=t.getChannelData(0);for(var n=0;n<4096;n++)e[n]=2*Math.random()-1;p=t})()}function g(t,e){let n=l.createOscillator();return n.type=t,n.frequency.value=e,n}function v(t){let e=l.createOscillator(),n=l.createGain();return e.type=t,e.connect(n),n.connect(s),[e,n]}function A(t,e,n,r){let o=l.createGain();return k(o.gain,t,e,n,r),o.connect(s),o}function k(t,e,n,r,o){t.setValueAtTime(n,e),t.exponentialRampToValueAtTime(o,r)}function b(t,e,n){t.start(e),t.stop(n)}c=()=>{l||d(),c=()=>{let[t,e]=v("triangle"),[n,r]=v("sine"),o=l.currentTime,i=o+.1;k(e.gain,o,1.5,i,.01),k(t.frequency,o,120,i,.001),k(r.gain,o,2,i,.01),k(n.frequency,o,50,i,.001),b(t,o,i),b(n,o,i)},c()},f=()=>{l||d(),f=()=>{let t=l.currentTime,e=t+.2,n=l.createBufferSource();n.buffer=p,n.loop=!0;let r=l.createBiquadFilter();r.type="highpass",k(r.frequency,t,100,e,1e3),n.connect(r);let o=A(t,.7,e,.01);r.connect(o);let[i,a]=v("triangle");k(a.gain,t,1,e,.01),k(i.frequency,t,120,e,.001),b(n,t,e),b(i,t,e)},f()},u=()=>{l||d(),u=()=>{let t=l.currentTime,e=t+.05,n=A(t,1,e,.01);n.connect(s);var r=l.createBiquadFilter();r.type="highpass",r.frequency.value=7e3,r.connect(n);let o=l.createBiquadFilter();o.type="bandpass",o.frequency.value=1e4,o.connect(r),[2,3,4.16,5.43,6.79,8.21].forEach(n=>{let r=g("square",40*n);r.connect(o),b(r,t,e)})},u()};let R=()=>{};m=t=>{l||d();let e=[],n=[],o=!1;m=t=>{R(),o=!0;let i=l.createGain();n.push(i),i.connect(s);let a=[.5,1];for(r of a){let n=g("square",t*r);n.connect(i),n.start(l.currentTime),e.push(n)}e[1].detune=.5},R=()=>{if(!o)return;o=!1;let t=l.currentTime+.2;e.forEach(e=>e.stop(t)),n.forEach(e=>e.gain.exponentialRampToValueAtTime(.01,t)),e=[],n=[]},m(t)};let T=0,F=0,M=!1,H=[];(()=>{for(let t=0;t<3;++t){let t=[[],[],[]];H.push(t)}let t=H;for(let e=0;e<16;++e)t[0][2][e]=1,t[1][2][e]=1,e%2==0&&(t[1][0][e]=1),e%4==0&&(t[0][0][e]=1,t[2][0][e]=1,t[2][2][e]=1),e%8==0&&(t[0][1][e]=1),e>=13&&(t[1][1][e]=1),15==e&&(t[2][1][e]=1)})();let L=H[2];keysUp=1,keysDown=2,keysLeft=4,keysRight=8,keysPunch=16,keysKick=32,keysSpecial=64,keysHeldUp=1024,keysHeldDown=2048,keysHeldLeft=4096,keysHeldRight=8192,keysHeldPunch=16384,keysHeldKick=32768,keysHeldSpecial=65536;let _=window.speechSynthesis,E=(t,e)=>{if(!_)return;t=(t=t.replace(/\s+/g," ")).replace(/[^a-zA-Z,.?! ]*/g,"");let n=new SpeechSynthesisUtterance(t),r=0,o=_.getVoices();if(o&&0!=o.length){if(e)for(let t=0;t<o.length;++t)if(o[t].name.toLocaleLowerCase().indexOf(e)>=0){r=t;break}n.voice=o[r],_.speak(n)}},S={},U={};document.body.addEventListener("keydown",t=>{S[t.key]||(U[t.key]=!0),S[t.key]=!0}),document.body.addEventListener("keyup",t=>{S[t.key]=!1});const C=["please\ndo not \nclick\n","please. \ngo.\naway.\n( ⚆ _ ⚆ )","no seriously,\ngo away,\nit's not safe\n\\( ﾟ▽ﾟ)/","fine, \nit's on \nyour head, then\n┌∩┐(ಠ_ಠ)┌∩┐"];let B=-100,D=document.querySelector("#t"),P=0,q=0,I=0,G=0;function N(t){E(C[t],"uk"),D.innerHTML=`<i>404</i><p>${C[t]}</p>`}function z(t){let e=0;previous=t.buffer[0];let n=[0,1,2,3,4,5,6];t.facingRight||(n=[0,1,3,2,4,5,6]);for(let r=0;r<=6;++r)S[t.r[n[r]]]&&(e|=1<<10+r),U[t.r[n[r]]]&&(e|=1<<r);t.buffer.unshift(e),t.buffer.pop()}D.addEventListener("click",()=>{if(new Date-q<1e3)return;if(P>=C.length-1)return;P+=1;let t=0;for(let e=0;e<1+P;++e)setTimeout(c,t),t+=450-50*P+100*Math.random();I=.2*(3*P+Math.random()),t+=500,D.innerHTML="<i>404</i><p>\n\n\n\n</p>",setTimeout(()=>{N(P)},t),P>=C.length-1&&(B=8),q=new Date}),N(0);let O=[0,0,1],V=Math.PI,j=Math.PI/2,K=t=>V*t/180,Y=Math.sin,$=Math.cos,W=Math.acos,X=Math.sqrt,Z=Math.min,J=Math.max;function Q(t,e,n){let r=(t=>Math.min(1,Math.max(0,t)))((n-t)/(e-t));return r*r*(3-2*r)}function tt(t,e,n){return t+(e-t)*n}function et(t,e,n){res=[];for(let r=0;r<3;++r)res[r]=tt(t[r],e[r],n);return res}function nt(){return 2*Math.random()-1}function rt(t,e,n,r){return[t[0]*e+n[0]*r,t[1]*e+n[1]*r,t[2]*e+n[2]*r]}function ot(t,e){return[t[0]-e[0],t[1]-e[1],t[2]-e[2]]}function it(t){return[-t[0],-t[1],-t[2]]}function at(t){return X(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])}function lt(t){var e=at(t);return e>1e-5?[t[0]/e,t[1]/e,t[2]/e]:[0,0,0]}function st(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function ct(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ft(t,e,n){var r=lt(ot(e,t)),o=lt(st(n,r)),i=lt(st(r,o));return[o[0],o[1],o[2],0,i[0],i[1],i[2],0,r[0],r[1],r[2],0,t[0],t[1],t[2],1]}function ut(t){return[t[12],t[13],t[14]]}function pt(t){return[[t[0],t[1],t[2]],[t[4],t[5],t[6]],[t[8],t[9],t[10]]]}function mt(t,e){return res=[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]],res}function ht(t,e){let n=[];for(y=0;y<4;++y)for(x=0;x<4;++x)for(n[4*y+x]=0,i=0;i<4;++i)n[4*y+x]+=e[4*y+i]*t[4*i+x];return n}function gt(t,e,n){return[1,0,0,0,0,1,0,0,0,0,1,0,t,e,n,1]}function yt(t){var e=$(t),n=Y(t);return[1,0,0,0,0,e,n,0,0,-n,e,0,0,0,0,1]}function wt(t,e,n){return[t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1]}function xt(t,e,n,r){return ht(t,gt(e,n,r))}function vt(t,e){return ht(t,yt(e))}function At(t,e){return ht(t,(t=>{var e=$(t),n=Y(t);return[e,0,-n,0,0,1,0,0,n,0,e,0,0,0,0,1]})(e))}function kt(t,e){return ht(t,(t=>{var e=$(t),n=Y(t);return[e,n,0,0,-n,e,0,0,0,0,1,0,0,0,0,1]})(e))}function bt(t,e,n,r){return ht(t,wt(e,n,r))}function Rt(t,e){let n=h.createShader(t);if(h.shaderSource(n,e),h.compileShader(n),h.getShaderParameter(n,h.COMPILE_STATUS))return n}function Tt(t,e){let n=Mt.attributes[t];h.vertexAttribPointer(n,3,h.FLOAT,!1,24,e),h.enableVertexAttribArray(n)}let Ft,Mt=(()=>{let t=((t,e)=>{let n=h.createProgram(),r=t=>h.attachShader(n,t);if(r(t),r(e),h.linkProgram(n),h.getProgramParameter(n,h.LINK_STATUS))return n})(Rt(h.VERTEX_SHADER,"attribute vec3 pos;\nattribute vec3 nrm;\nuniform mat4 proj;\nuniform mat4 view;\nuniform mat4 world;\nvarying vec3 vnrm;\nvoid main() {\n  vnrm = (world * vec4( nrm.xyz, 0 )).xyz;\n  gl_Position = proj * view * world * vec4( pos.xyz, 1 );\n}"),Rt(h.FRAGMENT_SHADER,"precision mediump float;\nvarying vec3 vnrm;\nuniform vec3 clr;\nuniform vec3 glow;\nvoid main() {\n  gl_FragColor=vec4(0,0,0,0.2);\n  vec3 nrm = vnrm;\n  vec3 col = clr;\n  if ( !gl_FrontFacing ) {nrm = -nrm;}\n  float i = 0.1;\n  gl_FragColor.rgb += col * vec3(1.0,0.6,0.5) * i;\n  i = max(0.0,dot(normalize(vec3(1,0.2,1)),nrm));\n  gl_FragColor.rgb += col * vec3(1.0,0.6,0.5) * i;\n  i = max(0.0,dot(normalize(vec3(-1,0.2,-0.3)),nrm));\n  gl_FragColor.rgb += col * vec3(0.3,0.4,0.5) * i;\n  gl_FragColor.rgb += glow;\n}\n")),e={};for(let n of["pos","nrm"])e[n]=h.getAttribLocation(t,n);let n={};for(let e of["proj","view","world","clr","glow"])n[e]=h.getUniformLocation(t,e);return{program:t,attributes:e,uniforms:n}})();function Ht(t){let e=[],n=t.length/3,r=n/3,o=(e,n)=>[t[e]-t[n],t[e+1]-t[n+1],t[e+2]-t[n+2]];for(let n=0;n<r;++n){let r=9*n,i=lt(st(o(r+3,r),o(r+6,r)));for(let n=0;n<3;++n)e.push(t[r+3*n]),e.push(t[r+3*n+1]),e.push(t[r+3*n+2]),e.push.apply(e,i)}let i=h.createBuffer();return h.bindBuffer(h.ARRAY_BUFFER,i),h.bufferData(h.ARRAY_BUFFER,new Float32Array(e),h.STATIC_DRAW),{buf:i,cnt:n}}function Lt(t,e){for(let n=0;n<t.length/3;++n){let r=3*n,o=[t[r++],t[r++],t[r++]];o=mt(e,o),r=3*n,t[r++]=o[0],t[r++]=o[1],t[r++]=o[2]}}function _t(t,e){let n=n=>t.push.apply(t,e[n]);n(0),n(1),n(3),n(1),n(2),n(3)}function Et(t,e,n,r){let o=[-e,-n,-r],i=[e,-n,-r],a=[e,n,-r],l=[-e,n,-r],s=[-e,-n,r],c=[e,-n,r],f=[e,n,r],u=[-e,n,r];_t(t,[o,i,a,l]),_t(t,[o,i,c,s]),_t(t,[i,a,f,c]),_t(t,[a,l,u,f]),_t(t,[l,o,s,u]),_t(t,[s,c,f,u])}function St(t,e,n,r){return instances.push({geo:t,pos:e||[0,0,0],rot:n||[0,0,0],scl:r||[1,1,1],mtx:gt(0,0,0),mtxs:gt(0,0,0),prn:null,clr:[1,1,1],glow:[0,0,0]}),instances.length-1}Ht([0,0,0,0,1,0,1,0,0]),window.instances=[],(()=>{let t=[];Et(t,1,1,1),Ft=Ht(t)})(),(()=>{w=6;let t=[];x0=-27;for(let e=0;e<10;++e)for(let n=0;n<10;++n){let r=[],o=2+.1*nt();Et(r,6/o,6/o,.1+.05*nt());let i=gt(6*n-27+.1*Math.random(),6*e-27+.1*Math.random(),-.6-.1*Math.random());i=vt(i,.02*nt()),i=At(i,.02*nt()),i=kt(i,.05*nt()),Lt(r,i),t.push.apply(t,r),r=[],Et(r,6/o,6/o,.2+.1*nt()),i=xt(i,0,0,.2),i=bt(i,.9,.9,1),Lt(r,i),t.push.apply(t,r)}let e=St(Ht(t));instances[e].clr=[.2,.3,.2]})();let Ut=[[],[]];function Ct(t,e,n,r,o,i,a,l){Ut[t].push({parent:e,mtx:gt(0,0,0),x:n,y:r,z:o,w:i/2,d:a/2,h:l/2,clr:[1,1,1],rot:0})}function Bt(t){let e=[],n=(n,r,o)=>{e.push(mt(t.mtx,[n,r,o]))};return n(-t.w,-t.d,-t.h),n(t.w,-t.d,-t.h),n(-t.w,t.d,-t.h),n(t.w,t.d,-t.h),n(-t.w,-t.d,t.h),n(t.w,-t.d,t.h),n(-t.w,t.d,t.h),n(t.w,t.d,t.h),e}function Dt(t,e){let n=Bt(t),r=Bt(e),o=t=>{let e=n.map(e=>ct(e,t)),o=r.map(e=>ct(e,t)),i=Z.apply(0,e),a=J.apply(0,e),l=Z.apply(0,o),s=J.apply(0,o);return l>a||i>s},i=pt(t.mtx),a=pt(e.mtx);for(let t=0;t<3;++t){if(o(i[t]))return!1;if(o(a[t]))return!1}return!0}let Pt=(()=>{let t=[],e=[],n=(t,n,r)=>e.push([t,n,r]);slice=(t,e)=>{n(-t,-t,e),n(t,-t,e),n(t,t,e),n(-t,t,e)},slice(.1,0),slice(.5,.1),slice(.3,.7),slice(.1,1);let r=(n,r,o,i)=>_t(t,[e[n],e[r],e[o],e[i]]),o=(t,e,n,o,i,a,l,s)=>{r(t,e,a,i),r(e,n,l,a),r(n,o,s,l),r(o,t,i,s)};return r(0,1,2,3),o(0,1,2,3,4,5,6,7),o(4,5,6,7,8,9,10,11),o(8,9,10,11,12,13,14,15),r(12,13,14,15),Ht(t)})(),qt=[.5,.3,1],It=[1,1,1];function Gt(t,e,n,r,o){let i=St(Pt,n,o,r);return instances[i].prn=e,instances[i].clr=t,i}let Nt=K(100);function zt(t){let e={};return e.index=t,e.a=St(null),e.b=Gt(qt,e.a,[0,0,6],[2,1,1]),e.c=Gt(qt,e.b,[0,0,1],[2,1,1]),e.d=Gt(qt,e.c,[0,0,1],[2,1,2]),e.e=Gt(It,e.d,[0,0,2],[1.7,1.5,2]),e.f=Gt(qt,e.b,[-.5,0,0],[1,1.5,3],[V,0,0]),e.g=Gt(qt,e.b,[.5,0,0],[1,1.5,3],[V,0,0]),e.h=Gt(It,e.f,[0,0,3],[1,1,3]),e.i=Gt(It,e.g,[0,0,3],[1,1,3]),e.j=Gt(It,e.a,[-.7,0,0],[1,.5,1.5],[Nt,-.1,0]),e.k=Gt(It,e.a,[.7,0,0,0],[1,.5,1.5],[Nt,.1,0]),e.l=Gt(qt,e.d,[-1.5,0,2],[1,1,2],[V,0,0]),e.m=Gt(qt,e.d,[1.5,0,2],[1,1,2],[V,0,0]),e.n=Gt(It,e.l,[0,0,2],[.7,.7,2]),e.o=Gt(It,e.m,[0,0,2],[.7,.7,2]),e.p=Gt(It,e.n,[0,0,2],[1,.5,1],[0,0,V/2]),e.q=Gt(It,e.o,[0,0,2],[1,.5,1],[0,0,V/2]),e.r={},e.s=[0,0,0],e.t=!1,e.u=!0,e.facingRight=!0,e.bHeight=5,e.bAdvance=0,e.buffer=[0,0,0,0,0,0,0,0,0,0,0],e.state=te,e.frame=0,e.ik=[1,1,0,0],e}function Ot(t,e,n,r){let o=instances[t],i=instances[e],a=ut(o.mtx),l=ut(instances[n].mtx),s=o.scl,c=i.scl,f=s[2],u=c[2],p=ot(a,l),m=at(p),h=.01,d=.999*(f+u);m<d?h=J(h,W((f*f+m*m-u*u)/(2*f*m))):(l=rt(l,1,p,(m-d)/m),((t,e,n,r)=>{t[12]=e,t[13]=n,t[14]=r})(instances[n].mtx,l[0],l[1],l[2])),o.mtx=ft(a,l,r),o.mtx=ht(o.mtx,yt(h)),i.mtx=xt(o.mtx,i.pos[0],i.pos[1],i.pos[2]),i.mtx=ft(ut(i.mtx),l,r),o.mtx=bt(o.mtx,s[0],s[1],s[2]),i.mtx=bt(i.mtx,c[0],c[1],c[2])}function Vt(t){let e=t.ik;return t.facingRight?e:[e[1],e[0],e[3],e[2]]}function jt(t,e){let n,r,o,i,a=Vt(t);a[0]&&([n,r,o]=pt(instances[t.j].mtxs),i=it(o),Ot(t.f,t.h,t.j,i)),a[1]&&([n,r,o]=pt(instances[t.k].mtxs),i=it(o),Ot(t.g,t.i,t.k,i)),a[2]&&([n,r,o]=pt(instances[t.p].mtxs),i=it(n),Ot(t.l,t.n,t.p,i)),a[3]&&([n,r,o]=pt(instances[t.q].mtxs),i=it(n),Ot(t.m,t.o,t.q,i)),instances[t.e].mtx=ht(ht(ft(ut(instances[t.e].mtx),ut(instances[e.e].mtx),O),yt(-j)),wt.apply(null,instances[t.e].scl))}function Kt(t,e){t.state=e,t.frame=0,t.state(t)}function Yt(t){let e=Zt(t.a);t.facingRight=ct(e[1],fe)<0,t.frame+=1,t.state(t);let n=Vt(t);instances[t.p].prn=n[2]?t.a:t.n,instances[t.q].prn=n[3]?t.a:t.o}function $t(t,e,n,r,o){if(t<e)return 0;let i=e+n+r;return t<i?Q(e,e+n,t):Q(i+o,i,t)}function Wt(t,e,n,r,o,i,a,l){l=l||.2,instances[t].pos=et(instances[t].pos,[e,n,r],l),instances[t].rot=et(instances[t].rot,[o,i,a],l)}function Xt(t,e,n,r,o){o=o||.2,instances[t].rot=et(instances[t].rot,[e,n,r],o)}function Zt(t){return pt(instances[t].mtxs)}function Jt(t,e,n){let r,o,i,a,l,s,c=1;t.facingRight?(r=t.l,o=t.n,i=t.p,a=t.m,l=t.o,s=t.q):(c=-1,r=t.m,o=t.o,i=t.q,a=t.l,l=t.n,s=t.p),Xt(r,e[0],c*e[1],c*e[2]),Xt(o,e[3],0,0),Xt(i,c*e[4],c*e[5],j),instances[i].pos=[0,0,2],Xt(a,n[0],c*n[1],c*n[2]),Xt(l,n[3],0,0),Xt(s,c*n[4],c*n[5],j),instances[s].pos=[0,0,2]}function Qt(t,e,n,r,o,i,a){let l,s,c=1;t.facingRight?(l=n,s=r):(c=-1,l=r,s=n),a=a||.3,Wt(t.b,e[0],e[1],e[2],e[3],c*e[4],c*e[5],a),Wt(t.j,c*l[0],l[1],l[2],l[3],c*l[4],l[5],a),Wt(t.k,c*s[0],s[1],s[2],s[3],c*s[4],s[5],a),Xt(t.c,o[0]||0,c*o[1]||0,c*o[2]||0,a),Xt(t.c,i[0]||0,c*i[1]||0,c*i[2]||0,a)}function te(t){let e=t.buffer[0];if(2048&e)return Kt(t,re);if(4096&e)return Kt(t,ne);if(9216&e)return Kt(t,ee);if(16&e)return Kt(t,oe);if(32&e)return Kt(t,ie);Ct(t.index,t.a,0,0,5,3,3,10),Zt(t.a);let n=t.frame/30,r=.4*$(n+.3+V/2),o=-.2*$(n+.7+V/2),i=5.2+.3*Y(2*n),a=.1*Y(n+.7);Qt(t,[0,r,i,0,o,K(60)+a],[-1.5,-1.5,0,Nt,-.2,0],[1.5,2,0,Nt,.9,0],[0,-o],[]),Jt(t,[K(180),K(-30),K(-30),K(-120),K(30),K(-20)],[K(180),K(30),K(-40),K(-120),K(-30),K(-20)]),t.ik=[1,1,0,0]}function ee(t){let e=t.buffer[0];if(!(11264&e))return Kt(t,te);Ct(t.index,t.a,0,0,5,3,3,10);let n=t.frame/-10,[r,o,i]=pt(instances[t.a].mtxs);r[2]=0,o[2]=0,8192&e&&(instances[t.a].pos=rt(instances[t.a].pos,1,o,-.1)),1024&e&&(instances[t.a].pos=rt(instances[t.a].pos,1,r,-.2)),2048&e&&(instances[t.a].pos=rt(instances[t.a].pos,1,r,.2));let a=.05*Y(n+.2);Qt(t,[0,0,5.2-.2*Y(2*n),.1,a,K(40)],[-.6,2*-$(n)+.2,.25*J(0,Y(n)),Nt,-.5,0],[.6,2*-$(n+V)+.3,.25*J(0,Y(n+V)),Nt,.9,0],[.2,-a],[-.2]),Jt(t,[K(180),K(-20),K(-10),K(15*Y(n)-130),K(30),K(-20)],[K(180),K(20),K(-10),K(5*$(n)-130),K(-30),K(-20)])}function ne(t){let e=t.buffer[0];if(!(4096&e))return Kt(t,te);Ct(t.index,t.a,0,0,5,3,3,10);let n=t.frame/10,[r,o,i]=pt(instances[t.a].mtxs);r[2]=0,o[2]=0,instances[t.a].pos=rt(instances[t.a].pos,1,o,.1),1024&e&&(instances[t.a].pos=rt(instances[t.a].pos,1,r,-.2)),2048&e&&(instances[t.a].pos=rt(instances[t.a].pos,1,r,.2)),Qt(t,[0,.5,5-.2*Y(2*n),0,0,K(40)],[-1,2*-$(n),J(0,Y(n)),Nt,-.6,0],[1,2*-$(n+V),J(0,Y(n+V)),Nt,.8,0],[.2],[-.3]),Jt(t,[K(160),K(10),K(-10),K(-120),K(30),K(-20)],[K(160),K(30),K(-90),K(-90),K(-30),K(-20)])}function re(t){if(!(2048&t.buffer[0]))return Kt(t,te);Ct(t.index,t.a,0,0,3,3,3,6);let e=t.frame/6,n=2.7+.15*Y(e);Qt(t,[0,1+.1*$(e-.7),n,0,0,K(40)],[-1.5,-1.5,0,Nt,-.6,0],[1.5,2,0,Nt,1.2,0],[.2],[-.3]),Jt(t,[K(120),K(10),K(-10),K(-120),K(30),K(-20)],[K(140),K(90),K(-90),K(-90),K(-30),K(-20)]),t.ik=[1,1,0,0]}function oe(t){if(t.frame>12)return Kt(t,te);Ct(t.index,t.a,0,-4.5,8,3,5,2);let e=$t(t.frame,1,3,1,8);Qt(t,[0,1.5*-e,5.2-.3*e,0,0,K(70)],[-1.5,-1.5,0,Nt,-.2,0],[1.5,2,0,Nt,1.1,0],[],[]),Jt(t,[K(90),K(0),K(0),K(0),K(30),K(-20)],[K(180),K(30),K(0),K(-150),K(-30),K(50)]),((t,e)=>{let n,r;t.facingRight?(n=t.p,r=t.q):(n=t.q,r=t.p),e&&(instances[n].pos=[e[0],e[1],e[2]],instances[n].rot=[e[3],e[4],e[5]])})(t,[0,-3-5*e,8.7,0,j,-j]),t.ik=[1,1,1,0]}function ie(t){if(t.frame>21)return Kt(t,te);Ct(t.index,t.a,0,-5.5,6,3,5,7);let e=$t(t.frame,5,3,5,7),n=$t(t.frame,0,3,19,3);Qt(t,[0,2.8*-e,5.2+.3*e,-1.5*e,0,K(70-60*n)],[-1.5,-1.5-8*e,10*e,Nt-e*j,-.2,0],[1.5-1*n,2-2*n,0,Nt,1.1-.7*n,0],[.7*e],[.9*e],.7),Jt(t,[K(180),K(-30),K(-30),K(-30),K(30),K(50)],[K(180+60*e),K(30),K(0),K(-30),K(-30),K(50)]),t.ik=[1,1,0,0]}window.player1=zt(0),qt=[.4,1,.5],window.player2=zt(1),instances[player1.a].pos[1]=-8,instances[player2.a].pos[1]=8,player1.r=["w","s","a","d","v","b","n"],player2.r=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","p","[","]"];let ae=[0,1,0],le=[0,0,6],se=[],ce=[],fe=[],ue=(t,e)=>h.uniformMatrix4fv(t,!1,e);function pe(){(()=>{let t=1*e/n;se=((t,e)=>{var n=Math.tan(.5*V-.5*t);return[n,0,0,0,0,n*e,0,0,0,0,-1.000666888962988,-1,0,0,-.2000666888962988,0]})(K(60),t);let r=ut(instances[player1.a].mtx),o=ut(instances[player2.a].mtx);fe=ot(o,r),fe[2]=0,fe=lt(fe);let i=[fe[1],-fe[0],0];le=rt(r,.5,o,.5),le[2]+=6;let a=Math.max(30,1.4*at(ot(r,o)));ae=[le[0],le[1],le[2]-.5],ae=rt(ae,1,i,-a),ce=ft(ae,le,O);for(let t=0;t<3;++t)ce[8+t]=-ce[8+t]})(),h.colorMask(!0,!0,!0,!0),h.clearColor(.1,.1,.15,1),h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT),h.colorMask(!0,!0,!0,!1),h.viewport(0,0,e,n),h.cullFace(h.FRONT_AND_BACK),h.enable(h.DEPTH_TEST),h.useProgram(Mt.program),ue(Mt.uniforms.view,(t=>{let e=gt(0,0,0);for(let n=0;n<3;++n)for(let r=0;r<3;++r)e[4*n+r]=t[4*r+n];for(let n=0;n<3;++n)for(let r=0;r<3;++r)e[12+n]+=-t[12+r]*e[4*r+n];return e})(ce)),ue(Mt.uniforms.proj,se),Tt("pos",0),Tt("nrm",12),z(player1),z(player2),Ut=[[],[]],Yt(player1),Yt(player2),(()=>{let t=ot(instances[player1.a].pos,instances[player2.a].pos),e=at(t);if(t[0]/=e,t[1]/=e,e<4){let n=(4-e)/2;instances[player1.a].pos=rt(instances[player1.a].pos,1,t,n),instances[player2.a].pos=rt(instances[player2.a].pos,1,t,-n)}let n=Math.atan2(-t[0],t[1]);player1.t||(instances[player1.a].rot[2]=n),player2.t||(instances[player2.a].rot[2]=V+n)})();for(let t of instances){let e;e=null!=t.prn?xt(instances[t.prn].mtxs,t.pos[0],t.pos[1],t.pos[2]):gt(t.pos[0],t.pos[1],t.pos[2]),e=kt(e,t.rot[2]),e=vt(e,t.rot[0]),e=At(e,t.rot[1]),t.mtxs=e.slice(),e=bt(e,t.scl[0],t.scl[1],t.scl[2]),t.mtx=e}jt(player1,player2),jt(player2,player1)}let me=0,he=0,de=requestAnimationFrame;tick=t=>{dt=Math.min(100,t-me),me=t,he+=dt,dt/=1e3;let e=t/1e3;for(;he>16.666666666666668;)pe(),he-=16.666666666666668;for(let t of instances)t.geo&&(h.bindBuffer(h.ARRAY_BUFFER,t.geo.buf),Tt("pos",0),Tt("nrm",12),h.uniform3fv(Mt.uniforms.clr,t.clr),h.uniform3fv(Mt.uniforms.glow,t.glow),ue(Mt.uniforms.world,t.mtx),h.drawArrays(h.TRIANGLES,0,t.geo.cnt));(()=>{let t=t=>{for(let e of t)void 0!==e.parent&&(e.mtx=xt(instances[e.parent].mtxs,e.x,e.y,e.z),e.mtx=vt(e.mtx,e.rot))},e=t=>{h.bindBuffer(h.ARRAY_BUFFER,Ft.buf);for(let e of t){Tt("pos",0),Tt("nrm",12),h.uniform3fv(Mt.uniforms.clr,[.2,.2,.2]),h.uniform3fv(Mt.uniforms.glow,e.clr);let t=bt(e.mtx,e.w,e.d,e.h);ue(Mt.uniforms.world,t),h.drawArrays(h.TRIANGLES,0,Ft.cnt)}};t(Ut[0]),t(Ut[1]);for(let t of Ut[0])for(let e of Ut[1])Dt(t,e)?(t.clr=[.6,0,0],e.clr=[.6,0,0]):(t.clr=[0,.6,0],e.clr=[0,.6,0]);h.enable(h.BLEND),h.blendFunc(h.SRC_ALPHA,h.ONE_MINUS_SRC_ALPHA),e(Ut[0]),e(Ut[1]),h.disable(h.BLEND)})(),((t,e)=>{if(B>0||0!=I){B>0&&(B-=e);let n=-50,r=-50;G+=100*-I*e,G*=.95,I+=G*e,n-=Y(t)*I,r+=$(t)*I;let o=`translate(${n.toFixed(3)}%,${r.toFixed(3)}%)`;if(B>0){let t=Q(0,4.5,B);D.style.opacity=t,o+=` scale(${4-3*t})`}else-100!=B&&(D.style.display="none",I=0,E("The first rule of four oh four club, is you don't talk about four oh four club. Ready? FIGHT!","日本"));D.style.transform=o}})(e,dt),(t=>{if(M){T+=t,T>4&&(T%=4,L=H[Math.floor(Math.random()*H.length)]);let e=Math.floor(T/.25);e!=F&&(L[0][e]&&c(),L[1][e]&&f(),L[2][e]&&u(),F=e)}U["="]&&(M=!M)})(dt),U={},de(tick)},de(tick);</script></body></html>